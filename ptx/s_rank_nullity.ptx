<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="s_rank_nullity">
  <title>Rank-nullity theorem and fundamental spaces</title>
  <introduction>
    In a sense, this section is just a long-format example of how to compute bases and dimensions of subspaces. Along the way, however we meet the <xref ref="th_rank-nullity" text="custom">rank-nullity theorem</xref> (sometimes called the <q>fundamental theorem of linear algebra</q>), and apply this theorem in the context of <em>fundamental spaces of matrices</em> (<xref ref="d_fundamental_space"/>)
  </introduction>

<definition xml:id="d_rank_nullity">
  <title>Rank and nullity</title>
  <idx><h>rank</h><h>of a linear transformation</h></idx>
  <idx><h>nullity</h><h>of a linear transformation</h></idx>
  <notation>
    <usage>\rank T</usage>
    <description>the rank of <m>T</m></description>
  </notation>
  <notation>
    <usage>\nullity T</usage>
    <description>the nullity of <m>T</m></description>
  </notation>
  <statement>
    <p>
      Let <m>T\colon V\rightarrow W</m> be a linear transformation.
      <ul>
        <li>
          <p>
            The <term>rank</term> of <m>T</m>, denoted <m>\rank T</m>, is the dimension of <m>\im T</m>: <ie />,
            <me>
              \rank T=\dim\im T
            </me>.
          </p>
        </li>
        <li>
          <p>
            The <term>nullity</term> of <m>T</m>, denoted <m>\nullity T</m>, is the dimension of <m>\NS T</m>: <ie />,
            <me>
              \nullity T=\dim\NS T
            </me>.
          </p>
        </li>
      </ul>
    </p>
  </statement>
</definition>
<theorem xml:id="th_rank-nullity">
  <title>Rank-nullity</title>
  <idx><h>rank-nullity theorem</h></idx>
  <statement>
    <p>
    Let <m>V</m> be a vector space of dimension <m>n</m>, and let <m>T\colon V\rightarrow W</m> be a linear transformation. Then
    <me>
      n=\dim\NS T+\dim\im T
    </me>,
      or alternatively,
      <me>
        n=\nullity T+\rank T
      </me>.

    </p>
  </statement>
</theorem>

<definition xml:id="d_fundamental_space">
  <title>Fundamental spaces</title>
  <idx><h>fundamental space</h><h>of a matrix</h></idx>
  <idx><h>null space</h><h>of a matrix</h></idx>
  <idx><h>row space</h><h>of a matrix</h></idx>
  <idx><h>column space</h><h>of a matrix</h></idx>
  <idx><h>rank</h><h>of a matrix</h></idx>
  <idx><h>nullity</h><h>of a matrix</h></idx>
  <notation>
    <usage>\NS A</usage>
    <description>the null space of matrix <m>A</m></description>
  </notation>
  <notation>
    <usage>\RS A</usage>
    <description>the row space of a matrix <m>A</m></description>
  </notation>
  <notation>
    <usage>\CS A</usage>
    <description>the column space of a matrix <m>A</m></description>
  </notation>
  <notation>
    <usage>\rank A</usage>
    <description>the rank of a matrix <m>A</m></description>
  </notation>
  <notation>
    <usage>\nullity A</usage>
    <description>the nullity of a matrix <m>A</m></description>
  </notation>
  <statement>
    <p>
      Let <m>A</m> be a an <m>m\times n</m> matrix. Let <m>\boldr_1,\dots, \boldr_m</m> be the <m>m</m> rows of <m>A</m>, and let <m>\boldc_1,\dots \boldc_n</m> be its <m>n</m> columns. The following subspaces are called the <term>fundamental subspaces of $A$</term>.
    </p>
    <ul>
      <li>
        <p>
          The <term>null space of <m>A</m></term>, denoted <m>\NS A</m> is defined as
          <me>
          \NS A =\{\boldx\in\R^n\colon A\boldx=\boldzero\}\subseteq \R^n.
          </me>.

        </p>
      </li>
      <li>
        <p>
          The <term>row space of <m>A</m></term>, denoted <m>\RS A</m>, is defined as
          <me>
            \RS A=\Span \{\boldr_1, \boldr_2, \dots, \boldr_m\}\subseteq \R^n
          </me>.

        </p>
      </li>
      <li>
        <p>
          The <term>column space of <m>A</m></term>, denoted <m>\CS A</m>, is defined as
          <me>
            \CS A=\Span \{\boldc_1, \boldc_2, \dots, \boldc_n\}\subseteq \R^m
          </me>.
        </p>
      </li>
    </ul>
    <p>
      The <term>rank</term> and <term>nullity</term> of <m>A</m>, denoted <m>\rank A</m> and <m>\nullity A</m>, respectively, are defined as <m>\rank A=\dim \CS A</m> and <m>\nullity A=\dim\NS A</m>.
    </p>
  </statement>
</definition>
<theorem xml:id="th_fundamental_spaces">
  <title>Fundamental spaces</title>
  <statement>
    <p>
    Let <m>A</m> be an <m>m\times n</m> matrix. Suppose <m>A</m> is row equivalent to the row echelon matrix <m>U</m>.
    </p>
    <ol>
      <li>
        <p>
          We have
          <ul>
            <li>
              <p>
                <m>\NS A=\NS U</m>
              </p>
            </li>
            <li>
              <p>
                <m>\RS A=\RS U</m>
              </p>
            </li>
            <li>
              <p>
                <m>\CS A\ne \CS U</m>, in general.
              </p>
            </li>
          </ul>
        </p>
      </li>
      <li>
        <p>
        Let <m>\ell </m> be the number of leading ones in <m>U</m>, and let <m>k=n-\ell</m>; <ie />, <m>\ell</m> and <m>k</m> are the number of leading and free variables, respectively, of the system corresponding to <m>\begin{amatrix}[r|r]U\amp \boldzero]\end{amatrix}</m>. Then
        <md>
          <mrow>\rank A\amp =\dim\CS A=\dim RS A=\ell </mrow>
          <mrow> \nullity A\amp=\dim\NS A=k </mrow>
        </md>.
        </p>
      </li>
      <li>
        <title>Rank-nullity for matrices</title>
        <p>
          We have
          <me>
            n=\dim\NS A+\dim\CS A=\dim\NS A+\dim\RS A
          </me>.
        </p>
      </li>
    </ol>
  </statement>
</theorem>
<algorithm xml:id="proc_fund_spaces">
  <title>Computing bases of fundamental spaces</title>
  <statement>
    <p>
      To compute bases for the fundamental spaces of an <m>m\times n</m> matrix <m>A</m>, proceed as follow.
    </p>
    <ol>
      <li>
        <p>
          Row reduce <m>A</m> to a matrix <m>U</m> in row echelon form.
        </p>
      </li>
      <li>
        <p>
        We have <m>\NS A=\NS U</m>. Compute a parametric description of the solutions to the linear system <m>U\boldx=\boldzero</m> following <xref ref="th_solveSystem"/>. If the free variables are <m>t_1, t_2, \dots, t_k </m>, a basis <m>B=\{\boldv_1, \boldv_2, \dots, \boldv_k\}</m> of <m>\NS A</m> is obtained by letting <m>\boldv_i</m> be the solution corresponding to the choice <m>t_i=1</m> and <m>t_j=0</m> for <m>j\ne i</m>.
        </p>
      </li>
      <li>
        <p>
          We have <m>\RS A=\RS U</m>. The set of nonzero rows of <m>U</m> is a basis for <m>\RS A</m>.
        </p>
      </li>
      <li>
        <p>
          In general <m>\CS A\ne \CS U</m>. However, the columns of <m>U</m> containing leading ones form a basis of <m>\CS U</m>, and the <em>corresponding columns</em> of <m>A</m> form a basis for <m>\CS A</m>.
        </p>
      </li>
    </ol>
  </statement>
</algorithm>

</section>
